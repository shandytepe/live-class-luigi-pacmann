/home/shandytp/learn-luigi/pertemuan-14/live-class/etl_pipeline.py:1: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd
DEBUG: Checking if ExtractHotelDatabase() is complete
INFO: Informed scheduler that task   ExtractHotelDatabase__99914b932b   has status   PENDING
DEBUG: Checking if ExtractAnimeData(year=2024, season=winter) is complete
INFO: Informed scheduler that task   ExtractAnimeData_winter_2024_307ccc7558   has status   PENDING
DEBUG: Checking if ExtractAPIMangaData() is complete
INFO: Informed scheduler that task   ExtractAPIMangaData__99914b932b   has status   PENDING
DEBUG: Checking if ValidateData() is complete
DEBUG: Checking if ExtractHotelDatabase() is complete
DEBUG: Checking if ExtractAnimeData(year=2024, season=winter) is complete
DEBUG: Checking if ExtractAPIMangaData() is complete
INFO: Informed scheduler that task   ValidateData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   ExtractAPIMangaData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   ExtractAnimeData_winter_2024_307ccc7558   has status   PENDING
INFO: Informed scheduler that task   ExtractHotelDatabase__99914b932b   has status   PENDING
DEBUG: Checking if TransformHotelData() is complete
DEBUG: Checking if ValidateData() is complete
INFO: Informed scheduler that task   TransformHotelData__99914b932b   has status   PENDING
DEBUG: Checking if ExtractHotelDatabase() is complete
DEBUG: Checking if ExtractAnimeData(year=2024, season=winter) is complete
DEBUG: Checking if ExtractAPIMangaData() is complete
INFO: Informed scheduler that task   ValidateData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   ExtractAPIMangaData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   ExtractAnimeData_winter_2024_307ccc7558   has status   PENDING
INFO: Informed scheduler that task   ExtractHotelDatabase__99914b932b   has status   PENDING
DEBUG: Checking if TransformAnimeData() is complete
DEBUG: Checking if ValidateData() is complete
INFO: Informed scheduler that task   TransformAnimeData__99914b932b   has status   PENDING
DEBUG: Checking if ExtractHotelDatabase() is complete
DEBUG: Checking if ExtractAnimeData(year=2024, season=winter) is complete
DEBUG: Checking if ExtractAPIMangaData() is complete
INFO: Informed scheduler that task   ValidateData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   ExtractAPIMangaData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   ExtractAnimeData_winter_2024_307ccc7558   has status   PENDING
INFO: Informed scheduler that task   ExtractHotelDatabase__99914b932b   has status   PENDING
DEBUG: Checking if TransformMangaData() is complete
DEBUG: Checking if ValidateData() is complete
INFO: Informed scheduler that task   TransformMangaData__99914b932b   has status   PENDING
DEBUG: Checking if ExtractHotelDatabase() is complete
DEBUG: Checking if ExtractAnimeData(year=2024, season=winter) is complete
DEBUG: Checking if ExtractAPIMangaData() is complete
INFO: Informed scheduler that task   ValidateData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   ExtractAPIMangaData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   ExtractAnimeData_winter_2024_307ccc7558   has status   PENDING
INFO: Informed scheduler that task   ExtractHotelDatabase__99914b932b   has status   PENDING
INFO: Done scheduling tasks
INFO: Running Worker with 1 processes
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 7
INFO: [pid 30001] Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) running   ExtractHotelDatabase()
INFO: [pid 30001] Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) done      ExtractHotelDatabase()
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   ExtractHotelDatabase__99914b932b   has status   DONE
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 6
INFO: [pid 30001] Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) running   ExtractAnimeData(year=2024, season=winter)
  0%|          | 0/88 [00:00<?, ?it/s]  2%|▏         | 2/88 [00:00<00:04, 19.43it/s]  5%|▍         | 4/88 [00:00<00:04, 18.95it/s]  7%|▋         | 6/88 [00:00<00:04, 18.84it/s]  9%|▉         | 8/88 [00:00<00:04, 19.01it/s] 11%|█▏        | 10/88 [00:00<00:04, 19.06it/s] 14%|█▎        | 12/88 [00:00<00:03, 19.12it/s] 16%|█▌        | 14/88 [00:00<00:03, 19.11it/s] 18%|█▊        | 16/88 [00:00<00:03, 19.05it/s] 20%|██        | 18/88 [00:00<00:03, 19.00it/s] 23%|██▎       | 20/88 [00:01<00:03, 19.09it/s] 25%|██▌       | 22/88 [00:01<00:03, 19.14it/s] 27%|██▋       | 24/88 [00:01<00:03, 19.12it/s] 30%|██▉       | 26/88 [00:01<00:03, 18.97it/s] 32%|███▏      | 28/88 [00:01<00:03, 18.77it/s] 34%|███▍      | 30/88 [00:01<00:03, 18.49it/s] 36%|███▋      | 32/88 [00:01<00:02, 18.71it/s] 39%|███▊      | 34/88 [00:01<00:02, 18.83it/s] 41%|████      | 36/88 [00:01<00:02, 18.51it/s] 43%|████▎     | 38/88 [00:02<00:02, 18.60it/s] 45%|████▌     | 40/88 [00:02<00:02, 18.61it/s] 48%|████▊     | 42/88 [00:02<00:02, 18.86it/s] 50%|█████     | 44/88 [00:02<00:02, 19.00it/s] 52%|█████▏    | 46/88 [00:02<00:02, 19.07it/s] 55%|█████▍    | 48/88 [00:02<00:02, 19.06it/s] 57%|█████▋    | 50/88 [00:02<00:01, 19.07it/s] 59%|█████▉    | 52/88 [00:02<00:01, 19.07it/s] 61%|██████▏   | 54/88 [00:02<00:01, 19.11it/s] 64%|██████▎   | 56/88 [00:02<00:01, 19.12it/s] 66%|██████▌   | 58/88 [00:03<00:01, 19.11it/s] 68%|██████▊   | 60/88 [00:03<00:01, 19.09it/s] 70%|███████   | 62/88 [00:03<00:01, 19.10it/s] 73%|███████▎  | 64/88 [00:03<00:01, 19.18it/s] 75%|███████▌  | 66/88 [00:03<00:01, 19.18it/s] 77%|███████▋  | 68/88 [00:03<00:01, 19.24it/s] 80%|███████▉  | 70/88 [00:03<00:00, 19.23it/s] 82%|████████▏ | 72/88 [00:03<00:00, 19.10it/s] 84%|████████▍ | 74/88 [00:03<00:00, 19.01it/s] 86%|████████▋ | 76/88 [00:04<00:00, 19.02it/s] 89%|████████▊ | 78/88 [00:04<00:00, 19.00it/s] 91%|█████████ | 80/88 [00:04<00:00, 18.99it/s] 93%|█████████▎| 82/88 [00:04<00:00, 18.97it/s] 95%|█████████▌| 84/88 [00:04<00:00, 19.09it/s] 98%|█████████▊| 86/88 [00:04<00:00, 19.12it/s]100%|██████████| 88/88 [00:04<00:00, 19.12it/s]100%|██████████| 88/88 [00:04<00:00, 19.00it/s]
  0%|          | 0/23 [00:00<?, ?it/s]  9%|▊         | 2/23 [00:00<00:01, 19.50it/s] 17%|█▋        | 4/23 [00:00<00:00, 19.43it/s] 26%|██▌       | 6/23 [00:00<00:00, 19.42it/s] 35%|███▍      | 8/23 [00:00<00:00, 19.45it/s] 43%|████▎     | 10/23 [00:00<00:00, 19.39it/s] 52%|█████▏    | 12/23 [00:00<00:00, 19.40it/s] 61%|██████    | 14/23 [00:00<00:00, 19.39it/s] 70%|██████▉   | 16/23 [00:00<00:00, 19.35it/s] 78%|███████▊  | 18/23 [00:00<00:00, 19.17it/s] 87%|████████▋ | 20/23 [00:01<00:00, 19.06it/s] 96%|█████████▌| 22/23 [00:01<00:00, 19.14it/s]100%|██████████| 23/23 [00:01<00:00, 19.28it/s]
  0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 19.50it/s]100%|██████████| 2/2 [00:00<00:00, 19.46it/s]
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 18.85it/s] 29%|██▊       | 4/14 [00:00<00:00, 18.89it/s] 43%|████▎     | 6/14 [00:00<00:00, 18.97it/s] 57%|█████▋    | 8/14 [00:00<00:00, 18.97it/s] 71%|███████▏  | 10/14 [00:00<00:00, 18.99it/s] 86%|████████▌ | 12/14 [00:00<00:00, 18.94it/s]100%|██████████| 14/14 [00:00<00:00, 18.94it/s]100%|██████████| 14/14 [00:00<00:00, 18.93it/s]
INFO: [pid 30001] Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) done      ExtractAnimeData(year=2024, season=winter)
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   ExtractAnimeData_winter_2024_307ccc7558   has status   DONE
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 5
INFO: [pid 30001] Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) running   ExtractAPIMangaData()
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:04<16:20,  4.93s/it]  1%|          | 2/200 [00:06<10:17,  3.12s/it]  2%|▏         | 3/200 [00:08<08:16,  2.52s/it]  2%|▏         | 4/200 [00:10<07:16,  2.23s/it]  2%|▎         | 5/200 [00:12<06:40,  2.06s/it]  3%|▎         | 6/200 [00:13<06:12,  1.92s/it]  4%|▎         | 7/200 [00:15<06:02,  1.88s/it]  4%|▍         | 8/200 [00:17<05:59,  1.87s/it]  4%|▍         | 9/200 [00:19<05:55,  1.86s/it]  5%|▌         | 10/200 [00:21<05:52,  1.86s/it]  6%|▌         | 11/200 [00:22<05:45,  1.83s/it]  6%|▌         | 12/200 [00:24<05:41,  1.81s/it]  6%|▋         | 13/200 [00:26<05:38,  1.81s/it]  7%|▋         | 14/200 [00:28<05:39,  1.83s/it]  8%|▊         | 15/200 [00:30<05:35,  1.81s/it]  8%|▊         | 16/200 [00:31<05:31,  1.80s/it]  8%|▊         | 17/200 [00:33<05:32,  1.82s/it]  9%|▉         | 18/200 [00:35<05:28,  1.80s/it] 10%|▉         | 19/200 [00:37<05:26,  1.80s/it] 10%|█         | 20/200 [00:39<05:22,  1.79s/it] 10%|█         | 21/200 [00:40<05:19,  1.79s/it] 11%|█         | 22/200 [00:42<05:23,  1.82s/it] 12%|█▏        | 23/200 [00:44<05:25,  1.84s/it] 12%|█▏        | 24/200 [00:46<05:23,  1.84s/it] 12%|█▎        | 25/200 [00:48<05:18,  1.82s/it] 13%|█▎        | 26/200 [00:50<05:16,  1.82s/it] 14%|█▎        | 27/200 [00:51<05:15,  1.82s/it] 14%|█▍        | 28/200 [00:53<05:11,  1.81s/it] 14%|█▍        | 29/200 [00:55<05:07,  1.80s/it] 15%|█▌        | 30/200 [00:57<05:06,  1.80s/it] 16%|█▌        | 31/200 [00:59<05:07,  1.82s/it] 16%|█▌        | 32/200 [01:00<05:03,  1.81s/it] 16%|█▋        | 33/200 [01:02<05:04,  1.83s/it] 17%|█▋        | 34/200 [01:04<05:09,  1.86s/it] 18%|█▊        | 35/200 [01:06<05:06,  1.86s/it] 18%|█▊        | 36/200 [01:08<05:06,  1.87s/it] 18%|█▊        | 37/200 [01:10<04:59,  1.84s/it] 19%|█▉        | 38/200 [01:11<04:53,  1.81s/it] 20%|█▉        | 39/200 [01:13<04:52,  1.82s/it] 20%|██        | 40/200 [01:15<04:48,  1.80s/it] 20%|██        | 41/200 [01:17<04:45,  1.79s/it] 21%|██        | 42/200 [01:19<04:48,  1.82s/it] 22%|██▏       | 43/200 [01:20<04:43,  1.81s/it] 22%|██▏       | 44/200 [01:22<04:41,  1.80s/it] 22%|██▎       | 45/200 [01:24<04:39,  1.80s/it] 23%|██▎       | 46/200 [01:26<04:34,  1.79s/it] 24%|██▎       | 47/200 [01:28<04:31,  1.78s/it] 24%|██▍       | 48/200 [01:29<04:33,  1.80s/it] 24%|██▍       | 49/200 [01:31<04:30,  1.79s/it] 25%|██▌       | 50/200 [01:33<04:31,  1.81s/it] 26%|██▌       | 51/200 [01:35<04:29,  1.81s/it] 26%|██▌       | 52/200 [01:37<04:30,  1.83s/it] 26%|██▋       | 53/200 [01:39<04:31,  1.84s/it] 27%|██▋       | 54/200 [01:40<04:25,  1.82s/it] 28%|██▊       | 55/200 [01:42<04:27,  1.85s/it] 28%|██▊       | 56/200 [01:44<04:28,  1.87s/it] 28%|██▊       | 57/200 [01:46<04:25,  1.86s/it] 29%|██▉       | 58/200 [01:48<04:22,  1.85s/it] 30%|██▉       | 59/200 [01:50<04:19,  1.84s/it] 30%|███       | 60/200 [01:51<04:15,  1.82s/it] 30%|███       | 61/200 [01:53<04:17,  1.85s/it] 31%|███       | 62/200 [01:55<04:11,  1.82s/it] 32%|███▏      | 63/200 [01:57<04:10,  1.83s/it] 32%|███▏      | 64/200 [01:59<04:08,  1.83s/it] 32%|███▎      | 65/200 [02:01<04:04,  1.81s/it] 33%|███▎      | 66/200 [02:02<04:04,  1.83s/it] 34%|███▎      | 67/200 [02:04<04:01,  1.82s/it] 34%|███▍      | 68/200 [02:06<03:59,  1.81s/it] 34%|███▍      | 69/200 [02:08<03:57,  1.81s/it] 35%|███▌      | 70/200 [02:10<03:57,  1.83s/it] 36%|███▌      | 71/200 [02:12<03:57,  1.84s/it] 36%|███▌      | 72/200 [02:13<03:54,  1.83s/it] 36%|███▋      | 73/200 [02:15<03:56,  1.86s/it] 37%|███▋      | 74/200 [02:17<03:56,  1.87s/it] 38%|███▊      | 75/200 [02:19<03:51,  1.85s/it] 38%|███▊      | 76/200 [02:21<03:47,  1.83s/it] 38%|███▊      | 77/200 [02:23<03:46,  1.84s/it] 39%|███▉      | 78/200 [02:25<03:46,  1.86s/it] 40%|███▉      | 79/200 [02:27<03:51,  1.91s/it] 40%|████      | 80/200 [02:29<03:48,  1.90s/it] 40%|████      | 81/200 [02:30<03:42,  1.87s/it] 41%|████      | 82/200 [02:32<03:35,  1.82s/it] 42%|████▏     | 83/200 [02:34<03:36,  1.85s/it] 42%|████▏     | 84/200 [02:36<03:33,  1.84s/it] 42%|████▎     | 85/200 [02:38<03:35,  1.87s/it] 43%|████▎     | 86/200 [02:40<03:35,  1.89s/it] 44%|████▎     | 87/200 [02:42<03:33,  1.89s/it] 44%|████▍     | 88/200 [02:43<03:27,  1.86s/it] 44%|████▍     | 89/200 [02:45<03:25,  1.85s/it] 45%|████▌     | 90/200 [02:47<03:23,  1.85s/it] 46%|████▌     | 91/200 [02:49<03:21,  1.84s/it] 46%|████▌     | 92/200 [02:51<03:17,  1.83s/it] 46%|████▋     | 93/200 [02:52<03:17,  1.85s/it] 47%|████▋     | 94/200 [02:54<03:15,  1.84s/it] 48%|████▊     | 95/200 [02:56<03:12,  1.83s/it] 48%|████▊     | 96/200 [02:58<03:09,  1.83s/it] 48%|████▊     | 97/200 [03:00<03:12,  1.87s/it] 49%|████▉     | 98/200 [03:02<03:09,  1.86s/it] 50%|████▉     | 99/200 [03:04<03:15,  1.93s/it] 50%|█████     | 100/200 [03:06<03:11,  1.92s/it] 50%|█████     | 101/200 [03:08<03:05,  1.88s/it] 51%|█████     | 102/200 [03:09<03:02,  1.86s/it] 52%|█████▏    | 103/200 [03:11<02:59,  1.85s/it] 52%|█████▏    | 104/200 [03:13<02:57,  1.85s/it] 52%|█████▎    | 105/200 [03:15<02:53,  1.82s/it] 53%|█████▎    | 106/200 [03:17<02:50,  1.81s/it] 54%|█████▎    | 107/200 [03:18<02:47,  1.80s/it] 54%|█████▍    | 108/200 [03:20<02:44,  1.79s/it] 55%|█████▍    | 109/200 [03:22<02:43,  1.79s/it] 55%|█████▌    | 110/200 [03:24<02:41,  1.79s/it] 56%|█████▌    | 111/200 [03:26<02:40,  1.81s/it] 56%|█████▌    | 112/200 [03:27<02:38,  1.80s/it] 56%|█████▋    | 113/200 [03:29<02:36,  1.79s/it] 57%|█████▋    | 114/200 [03:31<02:34,  1.80s/it] 57%|█████▊    | 115/200 [03:33<02:31,  1.79s/it] 58%|█████▊    | 116/200 [03:34<02:29,  1.78s/it] 58%|█████▊    | 117/200 [03:36<02:29,  1.80s/it] 59%|█████▉    | 118/200 [03:38<02:28,  1.82s/it] 60%|█████▉    | 119/200 [03:40<02:27,  1.82s/it] 60%|██████    | 120/200 [03:42<02:27,  1.84s/it] 60%|██████    | 121/200 [03:44<02:24,  1.83s/it] 61%|██████    | 122/200 [03:45<02:21,  1.82s/it] 62%|██████▏   | 123/200 [03:47<02:18,  1.81s/it] 62%|██████▏   | 124/200 [03:49<02:17,  1.81s/it] 62%|██████▎   | 125/200 [03:51<02:16,  1.82s/it] 63%|██████▎   | 126/200 [03:53<02:13,  1.80s/it] 64%|██████▎   | 127/200 [03:54<02:12,  1.81s/it] 64%|██████▍   | 128/200 [03:56<02:11,  1.82s/it] 64%|██████▍   | 129/200 [03:58<02:10,  1.84s/it] 65%|██████▌   | 130/200 [04:00<02:07,  1.83s/it] 66%|██████▌   | 131/200 [04:02<02:06,  1.83s/it] 66%|██████▌   | 132/200 [04:04<02:03,  1.82s/it] 66%|██████▋   | 133/200 [04:06<02:03,  1.84s/it] 67%|██████▋   | 134/200 [04:07<02:01,  1.83s/it] 68%|██████▊   | 135/200 [04:09<02:00,  1.85s/it] 68%|██████▊   | 136/200 [04:11<01:59,  1.87s/it] 68%|██████▊   | 137/200 [04:13<01:56,  1.85s/it] 69%|██████▉   | 138/200 [04:15<01:53,  1.83s/it] 70%|██████▉   | 139/200 [04:17<01:51,  1.83s/it] 70%|███████   | 140/200 [04:18<01:48,  1.81s/it] 70%|███████   | 141/200 [04:20<01:46,  1.81s/it] 71%|███████   | 142/200 [04:22<01:45,  1.82s/it] 72%|███████▏  | 143/200 [04:24<01:43,  1.81s/it] 72%|███████▏  | 144/200 [04:26<01:42,  1.83s/it] 72%|███████▎  | 145/200 [04:28<01:41,  1.84s/it] 73%|███████▎  | 146/200 [04:29<01:39,  1.83s/it] 74%|███████▎  | 147/200 [04:31<01:37,  1.84s/it] 74%|███████▍  | 148/200 [04:33<01:34,  1.81s/it] 74%|███████▍  | 149/200 [04:35<01:32,  1.81s/it] 75%|███████▌  | 150/200 [04:37<01:30,  1.80s/it] 76%|███████▌  | 151/200 [04:38<01:28,  1.81s/it] 76%|███████▌  | 152/200 [04:40<01:26,  1.80s/it] 76%|███████▋  | 153/200 [04:42<01:25,  1.81s/it] 77%|███████▋  | 154/200 [04:44<01:21,  1.77s/it] 78%|███████▊  | 155/200 [04:46<01:21,  1.81s/it] 78%|███████▊  | 156/200 [04:47<01:19,  1.80s/it] 78%|███████▊  | 157/200 [04:49<01:17,  1.79s/it] 79%|███████▉  | 158/200 [04:51<01:15,  1.79s/it] 80%|███████▉  | 159/200 [04:53<01:13,  1.79s/it] 80%|████████  | 160/200 [04:55<01:12,  1.81s/it] 80%|████████  | 161/200 [04:56<01:10,  1.82s/it] 81%|████████  | 162/200 [04:58<01:08,  1.81s/it] 82%|████████▏ | 163/200 [05:00<01:07,  1.82s/it] 82%|████████▏ | 164/200 [05:02<01:05,  1.83s/it] 82%|████████▎ | 165/200 [05:04<01:04,  1.84s/it] 83%|████████▎ | 166/200 [05:05<01:02,  1.83s/it] 84%|████████▎ | 167/200 [05:07<00:59,  1.81s/it] 84%|████████▍ | 168/200 [05:09<00:58,  1.81s/it] 84%|████████▍ | 169/200 [05:11<00:56,  1.81s/it] 85%|████████▌ | 170/200 [05:13<00:54,  1.82s/it] 86%|████████▌ | 171/200 [05:15<00:52,  1.82s/it] 86%|████████▌ | 172/200 [05:16<00:50,  1.81s/it] 86%|████████▋ | 173/200 [05:18<00:48,  1.81s/it] 87%|████████▋ | 174/200 [05:20<00:46,  1.81s/it] 88%|████████▊ | 175/200 [05:22<00:45,  1.82s/it] 88%|████████▊ | 176/200 [05:24<00:43,  1.81s/it] 88%|████████▊ | 177/200 [05:25<00:41,  1.81s/it] 89%|████████▉ | 178/200 [05:27<00:40,  1.83s/it] 90%|████████▉ | 179/200 [05:29<00:38,  1.85s/it] 90%|█████████ | 180/200 [05:31<00:36,  1.84s/it] 90%|█████████ | 181/200 [05:33<00:34,  1.83s/it] 91%|█████████ | 182/200 [05:35<00:32,  1.82s/it] 92%|█████████▏| 183/200 [05:36<00:31,  1.83s/it] 92%|█████████▏| 184/200 [05:38<00:28,  1.81s/it] 92%|█████████▎| 185/200 [05:40<00:26,  1.79s/it] 93%|█████████▎| 186/200 [05:42<00:25,  1.80s/it] 94%|█████████▎| 187/200 [05:44<00:23,  1.80s/it] 94%|█████████▍| 188/200 [05:45<00:21,  1.79s/it] 94%|█████████▍| 189/200 [05:47<00:19,  1.76s/it] 95%|█████████▌| 190/200 [05:49<00:17,  1.76s/it] 96%|█████████▌| 191/200 [05:51<00:16,  1.78s/it] 96%|█████████▌| 192/200 [05:52<00:14,  1.80s/it] 96%|█████████▋| 193/200 [05:54<00:12,  1.81s/it] 97%|█████████▋| 194/200 [05:56<00:10,  1.83s/it] 98%|█████████▊| 195/200 [05:58<00:09,  1.83s/it] 98%|█████████▊| 196/200 [06:00<00:07,  1.82s/it] 98%|█████████▊| 197/200 [06:02<00:05,  1.81s/it] 99%|█████████▉| 198/200 [06:03<00:03,  1.80s/it]100%|█████████▉| 199/200 [06:05<00:01,  1.80s/it]100%|██████████| 200/200 [06:07<00:00,  1.83s/it]100%|██████████| 200/200 [06:07<00:00,  1.84s/it]
INFO: [pid 30001] Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) done      ExtractAPIMangaData()
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   ExtractAPIMangaData__99914b932b   has status   DONE
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 4
INFO: [pid 30001] Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) running   ValidateData()
INFO: [pid 30001] Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) done      ValidateData()
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   ValidateData__99914b932b   has status   DONE
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 3
INFO: [pid 30001] Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) running   TransformHotelData()
/home/shandytp/learn-luigi/pertemuan-14/live-class/etl_pipeline.py:191: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  transform_hotel_data[col] = transform_hotel_data[col].replace(CONVERT_VALUES)
INFO: [pid 30001] Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) done      TransformHotelData()
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   TransformHotelData__99914b932b   has status   DONE
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 2
INFO: [pid 30001] Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) running   TransformAnimeData()
INFO: [pid 30001] Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) done      TransformAnimeData()
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   TransformAnimeData__99914b932b   has status   DONE
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 1
INFO: [pid 30001] Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) running   TransformMangaData()
INFO: [pid 30001] Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) done      TransformMangaData()
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   TransformMangaData__99914b932b   has status   DONE
DEBUG: Asking scheduler for work...
DEBUG: Done
DEBUG: There are no more tasks to run at this time
INFO: Worker Worker(salt=3660763699, workers=1, host=shandytp, username=shandytp, pid=30001) was stopped. Shutting down Keep-Alive thread
INFO: 
===== Luigi Execution Summary =====

Scheduled 7 tasks of which:
* 7 ran successfully:
    - 1 ExtractAPIMangaData()
    - 1 ExtractAnimeData(year=2024, season=winter)
    - 1 ExtractHotelDatabase()
    - 1 TransformAnimeData()
    - 1 TransformHotelData()
    ...

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

===== Data Quality Pipeline Start =====

===== Check Data Shape =====

Data Shape for this Data (30000, 31)

===== Check Data Types =====

Column booking_id has data type int64
Column hotel has data type object
Column is_canceled has data type int64
Column lead_time has data type int64
Column arrival_date_week_number has data type int64
Column stays_in_weekend_nights has data type int64
Column stays_in_week_nights has data type int64
Column adults has data type int64
Column children has data type float64
Column babies has data type int64
Column meal has data type object
Column country has data type object
Column market_segment has data type object
Column distribution_channel has data type object
Column is_repeated_guest has data type int64
Column previous_cancellations has data type int64
Column previous_bookings_not_canceled has data type int64
Column reserved_room_type has data type object
Column assigned_room_type has data type object
Column booking_changes has data type int64
Column deposit_type has data type object
Column agent has data type float64
Column company has data type float64
Column days_in_waiting_list has data type int64
Column customer_type has data type object
Column adr has data type float64
Column required_car_parking_spaces has data type int64
Column total_of_special_requests has data type int64
Column reservation_status has data type object
Column reservation_status_date has data type object
Column arrival_date has data type object

===== Check Missing Values =====

Columns booking_id has percentages missing values 0.0 %
Columns hotel has percentages missing values 7.113333333333333 %
Columns is_canceled has percentages missing values 0.0 %
Columns lead_time has percentages missing values 0.0 %
Columns arrival_date_week_number has percentages missing values 0.0 %
Columns stays_in_weekend_nights has percentages missing values 0.0 %
Columns stays_in_week_nights has percentages missing values 0.0 %
Columns adults has percentages missing values 0.0 %
Columns children has percentages missing values 0.01 %
Columns babies has percentages missing values 0.0 %
Columns meal has percentages missing values 0.0 %
Columns country has percentages missing values 2.01 %
Columns market_segment has percentages missing values 3.8733333333333335 %
Columns distribution_channel has percentages missing values 0.0 %
Columns is_repeated_guest has percentages missing values 0.0 %
Columns previous_cancellations has percentages missing values 0.0 %
Columns previous_bookings_not_canceled has percentages missing values 0.0 %
Columns reserved_room_type has percentages missing values 0.0 %
Columns assigned_room_type has percentages missing values 0.0 %
Columns booking_changes has percentages missing values 0.0 %
Columns deposit_type has percentages missing values 0.0 %
Columns agent has percentages missing values 93.19666666666667 %
Columns company has percentages missing values 94.19666666666667 %
Columns days_in_waiting_list has percentages missing values 0.0 %
Columns customer_type has percentages missing values 0.0 %
Columns adr has percentages missing values 0.0 %
Columns required_car_parking_spaces has percentages missing values 0.0 %
Columns total_of_special_requests has percentages missing values 0.0 %
Columns reservation_status has percentages missing values 0.0 %
Columns reservation_status_date has percentages missing values 0.0 %
Columns arrival_date has percentages missing values 0.0 %
===== Data Quality Pipeline End =====

===== Data Quality Pipeline Start =====

===== Check Data Shape =====

Data Shape for this Data (127, 11)

===== Check Data Types =====

Column title has data type object
Column link_mal has data type object
Column release_date has data type object
Column anime_episode has data type object
Column anime_duration has data type object
Column anime_genre has data type object
Column img_link has data type object
Column description has data type object
Column studio has data type object
Column source has data type object
Column show_type has data type object

===== Check Missing Values =====

Columns title has percentages missing values 0.0 %
Columns link_mal has percentages missing values 0.0 %
Columns release_date has percentages missing values 0.0 %
Columns anime_episode has percentages missing values 0.0 %
Columns anime_duration has percentages missing values 0.0 %
Columns anime_genre has percentages missing values 0.0 %
Columns img_link has percentages missing values 90.55118110236221 %
Columns description has percentages missing values 0.0 %
Columns studio has percentages missing values 22.04724409448819 %
Columns source has percentages missing values 1.5748031496062993 %
Columns show_type has percentages missing values 0.0 %
===== Data Quality Pipeline End =====

===== Data Quality Pipeline Start =====

===== Check Data Shape =====

Data Shape for this Data (195, 15)

===== Check Data Types =====

Column manga_id has data type int64
Column url_manga has data type object
Column title has data type object
Column title_english has data type object
Column title_japanese has data type object
Column chapters has data type float64
Column volumes has data type float64
Column status has data type object
Column start_published has data type object
Column end_published has data type object
Column score has data type float64
Column rank has data type float64
Column authors has data type object
Column genres has data type object
Column themes has data type object

===== Check Missing Values =====

Columns manga_id has percentages missing values 0.0 %
Columns url_manga has percentages missing values 0.0 %
Columns title has percentages missing values 0.0 %
Columns title_english has percentages missing values 15.897435897435898 %
Columns title_japanese has percentages missing values 0.0 %
Columns chapters has percentages missing values 5.641025641025641 %
Columns volumes has percentages missing values 5.128205128205129 %
Columns status has percentages missing values 0.0 %
Columns start_published has percentages missing values 0.5128205128205128 %
Columns end_published has percentages missing values 15.384615384615385 %
Columns score has percentages missing values 2.5641025641025643 %
Columns rank has percentages missing values 4.102564102564102 %
Columns authors has percentages missing values 0.0 %
Columns genres has percentages missing values 0.0 %
Columns themes has percentages missing values 0.0 %
===== Data Quality Pipeline End =====

Start Convert values Column is_canceled
End of Process
Start Convert values Column is_repeated_guest
End of Process
/home/shandytp/learn-luigi/pertemuan-14/live-class/etl_pipeline.py:1: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd
DEBUG: Checking if ExtractHotelDatabase() is complete
INFO: Informed scheduler that task   ExtractHotelDatabase__99914b932b   has status   DONE
DEBUG: Checking if ExtractAnimeData(year=2024, season=winter) is complete
INFO: Informed scheduler that task   ExtractAnimeData_winter_2024_307ccc7558   has status   DONE
DEBUG: Checking if ExtractAPIMangaData() is complete
INFO: Informed scheduler that task   ExtractAPIMangaData__99914b932b   has status   DONE
DEBUG: Checking if ValidateData() is complete
INFO: Informed scheduler that task   ValidateData__99914b932b   has status   DONE
DEBUG: Checking if TransformHotelData() is complete
INFO: Informed scheduler that task   TransformHotelData__99914b932b   has status   DONE
DEBUG: Checking if TransformAnimeData() is complete
INFO: Informed scheduler that task   TransformAnimeData__99914b932b   has status   DONE
DEBUG: Checking if TransformMangaData() is complete
INFO: Informed scheduler that task   TransformMangaData__99914b932b   has status   DONE
DEBUG: Checking if LoadData() is complete
DEBUG: Checking if TransformHotelData() is complete
DEBUG: Checking if TransformAnimeData() is complete
DEBUG: Checking if TransformMangaData() is complete
INFO: Informed scheduler that task   LoadData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   TransformMangaData__99914b932b   has status   DONE
INFO: Informed scheduler that task   TransformAnimeData__99914b932b   has status   DONE
INFO: Informed scheduler that task   TransformHotelData__99914b932b   has status   DONE
INFO: Done scheduling tasks
INFO: Running Worker with 1 processes
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 1
INFO: [pid 30798] Worker Worker(salt=7088303765, workers=1, host=shandytp, username=shandytp, pid=30798) running   LoadData()
INFO: [pid 30798] Worker Worker(salt=7088303765, workers=1, host=shandytp, username=shandytp, pid=30798) done      LoadData()
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   LoadData__99914b932b   has status   DONE
DEBUG: Asking scheduler for work...
DEBUG: Done
DEBUG: There are no more tasks to run at this time
INFO: Worker Worker(salt=7088303765, workers=1, host=shandytp, username=shandytp, pid=30798) was stopped. Shutting down Keep-Alive thread
INFO: 
===== Luigi Execution Summary =====

Scheduled 8 tasks of which:
* 7 complete ones were encountered:
    - 1 ExtractAPIMangaData()
    - 1 ExtractAnimeData(year=2024, season=winter)
    - 1 ExtractHotelDatabase()
    - 1 TransformAnimeData()
    - 1 TransformHotelData()
    ...
* 1 ran successfully:
    - 1 LoadData()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

/home/shandytp/learn-luigi/pertemuan-14/live-class/etl_pipeline.py:1: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd
DEBUG: Checking if ExtractHotelDatabase() is complete
INFO: Informed scheduler that task   ExtractHotelDatabase__99914b932b   has status   PENDING
DEBUG: Checking if ExtractAnimeData(year=2024, season=winter) is complete
INFO: Informed scheduler that task   ExtractAnimeData_winter_2024_307ccc7558   has status   PENDING
DEBUG: Checking if ExtractAPIMangaData() is complete
INFO: Informed scheduler that task   ExtractAPIMangaData__99914b932b   has status   PENDING
DEBUG: Checking if ValidateData() is complete
INFO: Informed scheduler that task   ValidateData__99914b932b   has status   DONE
DEBUG: Checking if TransformHotelData() is complete
DEBUG: Checking if ValidateData() is complete
INFO: Informed scheduler that task   TransformHotelData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   ValidateData__99914b932b   has status   DONE
DEBUG: Checking if TransformAnimeData() is complete
DEBUG: Checking if ValidateData() is complete
INFO: Informed scheduler that task   TransformAnimeData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   ValidateData__99914b932b   has status   DONE
DEBUG: Checking if TransformMangaData() is complete
DEBUG: Checking if ValidateData() is complete
INFO: Informed scheduler that task   TransformMangaData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   ValidateData__99914b932b   has status   DONE
DEBUG: Checking if LoadData() is complete
DEBUG: Checking if TransformHotelData() is complete
DEBUG: Checking if TransformAnimeData() is complete
DEBUG: Checking if TransformMangaData() is complete
INFO: Informed scheduler that task   LoadData__99914b932b   has status   PENDING
DEBUG: Checking if ValidateData() is complete
INFO: Informed scheduler that task   TransformMangaData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   ValidateData__99914b932b   has status   DONE
INFO: Informed scheduler that task   TransformAnimeData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   TransformHotelData__99914b932b   has status   PENDING
INFO: Done scheduling tasks
INFO: Running Worker with 1 processes
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 7
INFO: [pid 33679] Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) running   ExtractHotelDatabase()
INFO: [pid 33679] Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) done      ExtractHotelDatabase()
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   ExtractHotelDatabase__99914b932b   has status   DONE
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 6
INFO: [pid 33679] Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) running   ExtractAnimeData(year=2024, season=winter)
  0%|          | 0/88 [00:00<?, ?it/s]  2%|▏         | 2/88 [00:00<00:04, 19.50it/s]  5%|▍         | 4/88 [00:00<00:04, 18.71it/s]  7%|▋         | 6/88 [00:00<00:04, 18.57it/s]  9%|▉         | 8/88 [00:00<00:04, 18.73it/s] 11%|█▏        | 10/88 [00:00<00:04, 18.77it/s] 14%|█▎        | 12/88 [00:00<00:04, 18.78it/s] 16%|█▌        | 14/88 [00:00<00:03, 18.88it/s] 18%|█▊        | 16/88 [00:00<00:03, 18.91it/s] 20%|██        | 18/88 [00:00<00:03, 19.01it/s] 23%|██▎       | 20/88 [00:01<00:03, 19.08it/s] 25%|██▌       | 22/88 [00:01<00:03, 19.18it/s] 27%|██▋       | 24/88 [00:01<00:03, 19.26it/s] 30%|██▉       | 26/88 [00:01<00:03, 19.22it/s] 32%|███▏      | 28/88 [00:01<00:03, 19.24it/s] 34%|███▍      | 30/88 [00:01<00:03, 19.25it/s] 36%|███▋      | 32/88 [00:01<00:02, 19.28it/s] 39%|███▊      | 34/88 [00:01<00:02, 19.30it/s] 41%|████      | 36/88 [00:01<00:02, 19.09it/s] 43%|████▎     | 38/88 [00:01<00:02, 19.11it/s] 45%|████▌     | 40/88 [00:02<00:02, 19.15it/s] 48%|████▊     | 42/88 [00:02<00:02, 19.16it/s] 50%|█████     | 44/88 [00:02<00:02, 19.23it/s] 52%|█████▏    | 46/88 [00:02<00:02, 19.16it/s] 55%|█████▍    | 48/88 [00:02<00:02, 19.10it/s] 57%|█████▋    | 50/88 [00:02<00:01, 19.14it/s] 59%|█████▉    | 52/88 [00:02<00:01, 19.16it/s] 61%|██████▏   | 54/88 [00:02<00:01, 19.17it/s] 64%|██████▎   | 56/88 [00:02<00:01, 19.16it/s] 66%|██████▌   | 58/88 [00:03<00:01, 19.15it/s] 68%|██████▊   | 60/88 [00:03<00:01, 19.17it/s] 70%|███████   | 62/88 [00:03<00:01, 19.16it/s] 73%|███████▎  | 64/88 [00:03<00:01, 19.14it/s] 75%|███████▌  | 66/88 [00:03<00:01, 19.15it/s] 77%|███████▋  | 68/88 [00:03<00:01, 19.20it/s] 80%|███████▉  | 70/88 [00:03<00:00, 19.00it/s] 82%|████████▏ | 72/88 [00:03<00:00, 18.99it/s] 84%|████████▍ | 74/88 [00:03<00:00, 19.09it/s] 86%|████████▋ | 76/88 [00:03<00:00, 19.13it/s] 89%|████████▊ | 78/88 [00:04<00:00, 19.08it/s] 91%|█████████ | 80/88 [00:04<00:00, 19.12it/s] 93%|█████████▎| 82/88 [00:04<00:00, 19.18it/s] 95%|█████████▌| 84/88 [00:04<00:00, 19.17it/s] 98%|█████████▊| 86/88 [00:04<00:00, 19.07it/s]100%|██████████| 88/88 [00:04<00:00, 19.13it/s]100%|██████████| 88/88 [00:04<00:00, 19.10it/s]
  0%|          | 0/23 [00:00<?, ?it/s]  9%|▊         | 2/23 [00:00<00:01, 18.86it/s] 17%|█▋        | 4/23 [00:00<00:00, 19.02it/s] 26%|██▌       | 6/23 [00:00<00:00, 19.17it/s] 35%|███▍      | 8/23 [00:00<00:00, 19.20it/s] 43%|████▎     | 10/23 [00:00<00:00, 19.28it/s] 52%|█████▏    | 12/23 [00:00<00:00, 19.26it/s] 61%|██████    | 14/23 [00:00<00:00, 19.12it/s] 70%|██████▉   | 16/23 [00:00<00:00, 19.18it/s] 78%|███████▊  | 18/23 [00:00<00:00, 19.20it/s] 87%|████████▋ | 20/23 [00:01<00:00, 19.26it/s] 96%|█████████▌| 22/23 [00:01<00:00, 19.23it/s]100%|██████████| 23/23 [00:01<00:00, 19.20it/s]
  0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 18.94it/s]100%|██████████| 2/2 [00:00<00:00, 18.81it/s]
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 19.49it/s] 29%|██▊       | 4/14 [00:00<00:00, 19.29it/s] 43%|████▎     | 6/14 [00:00<00:00, 19.28it/s] 57%|█████▋    | 8/14 [00:00<00:00, 19.21it/s] 71%|███████▏  | 10/14 [00:00<00:00, 19.23it/s] 86%|████████▌ | 12/14 [00:00<00:00, 19.24it/s]100%|██████████| 14/14 [00:00<00:00, 19.22it/s]100%|██████████| 14/14 [00:00<00:00, 19.24it/s]
INFO: [pid 33679] Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) done      ExtractAnimeData(year=2024, season=winter)
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   ExtractAnimeData_winter_2024_307ccc7558   has status   DONE
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 5
INFO: [pid 33679] Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) running   ExtractAPIMangaData()
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<06:02,  1.82s/it]  1%|          | 2/200 [00:03<05:55,  1.80s/it]  2%|▏         | 3/200 [00:05<06:00,  1.83s/it]  2%|▏         | 4/200 [00:07<05:56,  1.82s/it]  2%|▎         | 5/200 [00:09<06:28,  1.99s/it]  3%|▎         | 6/200 [00:11<06:51,  2.12s/it]  4%|▎         | 7/200 [00:13<06:29,  2.02s/it]  4%|▍         | 8/200 [00:15<06:17,  1.97s/it]  4%|▍         | 9/200 [00:17<06:08,  1.93s/it]  5%|▌         | 10/200 [00:19<05:57,  1.88s/it]  6%|▌         | 11/200 [00:21<05:50,  1.85s/it]  6%|▌         | 12/200 [00:23<06:43,  2.14s/it]  6%|▋         | 13/200 [00:25<06:32,  2.10s/it]  7%|▋         | 14/200 [00:27<06:15,  2.02s/it]  8%|▊         | 15/200 [00:29<06:06,  1.98s/it]  8%|▊         | 16/200 [00:31<06:00,  1.96s/it]  8%|▊         | 17/200 [00:33<05:49,  1.91s/it]  9%|▉         | 18/200 [00:35<05:40,  1.87s/it] 10%|▉         | 19/200 [00:36<05:34,  1.85s/it] 10%|█         | 20/200 [00:38<05:31,  1.84s/it] 10%|█         | 21/200 [00:40<05:29,  1.84s/it] 11%|█         | 22/200 [00:42<05:23,  1.82s/it] 12%|█▏        | 23/200 [00:44<05:19,  1.80s/it] 12%|█▏        | 24/200 [00:45<05:17,  1.80s/it] 12%|█▎        | 25/200 [00:47<05:14,  1.80s/it] 13%|█▎        | 26/200 [00:49<05:10,  1.79s/it] 14%|█▎        | 27/200 [00:51<05:09,  1.79s/it] 14%|█▍        | 28/200 [00:52<05:10,  1.80s/it] 14%|█▍        | 29/200 [00:54<05:11,  1.82s/it] 15%|█▌        | 30/200 [00:56<05:11,  1.83s/it] 16%|█▌        | 31/200 [00:58<05:07,  1.82s/it] 16%|█▌        | 32/200 [01:00<05:02,  1.80s/it] 16%|█▋        | 33/200 [01:16<16:56,  6.09s/it] 17%|█▋        | 34/200 [01:18<13:16,  4.80s/it] 18%|█▊        | 35/200 [01:20<10:46,  3.92s/it] 18%|█▊        | 36/200 [01:21<08:56,  3.27s/it] 18%|█▊        | 37/200 [01:23<07:42,  2.84s/it] 19%|█▉        | 38/200 [01:25<06:52,  2.54s/it] 20%|█▉        | 39/200 [01:27<06:12,  2.31s/it] 20%|██        | 40/200 [01:29<05:45,  2.16s/it] 20%|██        | 41/200 [01:30<05:26,  2.05s/it] 21%|██        | 42/200 [01:32<05:14,  1.99s/it] 22%|██▏       | 43/200 [01:34<05:07,  1.96s/it] 22%|██▏       | 44/200 [01:36<05:00,  1.93s/it] 22%|██▎       | 45/200 [01:38<04:57,  1.92s/it] 23%|██▎       | 46/200 [01:40<04:48,  1.87s/it] 24%|██▎       | 47/200 [01:41<04:47,  1.88s/it] 24%|██▍       | 48/200 [01:43<04:42,  1.86s/it] 24%|██▍       | 49/200 [01:45<04:37,  1.84s/it] 25%|██▌       | 50/200 [01:47<04:33,  1.82s/it] 26%|██▌       | 51/200 [01:49<04:29,  1.81s/it] 26%|██▌       | 52/200 [01:50<04:26,  1.80s/it] 26%|██▋       | 53/200 [01:52<04:24,  1.80s/it] 27%|██▋       | 54/200 [01:54<04:26,  1.82s/it] 28%|██▊       | 55/200 [01:56<04:23,  1.81s/it] 28%|██▊       | 56/200 [01:58<04:22,  1.83s/it] 28%|██▊       | 57/200 [02:00<04:21,  1.83s/it] 29%|██▉       | 58/200 [02:01<04:18,  1.82s/it] 30%|██▉       | 59/200 [02:03<04:15,  1.81s/it] 30%|███       | 60/200 [02:05<04:11,  1.79s/it] 30%|███       | 61/200 [02:07<04:10,  1.81s/it] 31%|███       | 62/200 [02:09<04:08,  1.80s/it] 32%|███▏      | 63/200 [02:10<04:07,  1.81s/it] 32%|███▏      | 64/200 [02:12<04:05,  1.80s/it] 32%|███▎      | 65/200 [02:14<04:03,  1.81s/it] 33%|███▎      | 66/200 [02:16<04:02,  1.81s/it] 34%|███▎      | 67/200 [02:18<04:05,  1.84s/it] 34%|███▍      | 68/200 [02:19<03:59,  1.82s/it] 34%|███▍      | 69/200 [02:21<03:56,  1.81s/it] 35%|███▌      | 70/200 [02:23<03:53,  1.80s/it] 36%|███▌      | 71/200 [02:25<03:50,  1.79s/it] 36%|███▌      | 72/200 [02:27<03:52,  1.81s/it] 36%|███▋      | 73/200 [02:28<03:49,  1.81s/it] 37%|███▋      | 74/200 [02:30<03:47,  1.80s/it] 38%|███▊      | 75/200 [02:32<03:45,  1.81s/it] 38%|███▊      | 76/200 [02:34<03:45,  1.82s/it] 38%|███▊      | 77/200 [02:36<03:43,  1.82s/it] 39%|███▉      | 78/200 [02:38<03:41,  1.82s/it] 40%|███▉      | 79/200 [02:39<03:38,  1.81s/it] 40%|████      | 80/200 [02:41<03:35,  1.80s/it] 40%|████      | 81/200 [02:43<03:33,  1.79s/it] 41%|████      | 82/200 [02:45<03:50,  1.95s/it] 42%|████▏     | 83/200 [02:47<03:43,  1.91s/it] 42%|████▏     | 84/200 [02:49<03:40,  1.90s/it] 42%|████▎     | 85/200 [02:51<03:36,  1.88s/it] 43%|████▎     | 86/200 [02:53<03:31,  1.86s/it] 44%|████▎     | 87/200 [02:54<03:29,  1.85s/it] 44%|████▍     | 88/200 [02:56<03:24,  1.82s/it] 44%|████▍     | 89/200 [02:58<03:21,  1.82s/it] 45%|████▌     | 90/200 [03:00<03:18,  1.81s/it] 46%|████▌     | 91/200 [03:02<03:17,  1.81s/it] 46%|████▌     | 92/200 [03:03<03:15,  1.81s/it] 46%|████▋     | 93/200 [03:05<03:15,  1.83s/it] 47%|████▋     | 94/200 [03:07<03:11,  1.81s/it] 48%|████▊     | 95/200 [03:09<03:09,  1.80s/it] 48%|████▊     | 96/200 [03:11<03:07,  1.80s/it] 48%|████▊     | 97/200 [03:12<03:04,  1.79s/it] 49%|████▉     | 98/200 [03:14<03:02,  1.79s/it] 50%|████▉     | 99/200 [03:16<03:02,  1.81s/it] 50%|█████     | 100/200 [03:18<03:03,  1.83s/it] 50%|█████     | 101/200 [03:20<02:59,  1.82s/it] 51%|█████     | 102/200 [03:21<02:58,  1.82s/it] 52%|█████▏    | 103/200 [03:23<02:57,  1.83s/it] 52%|█████▏    | 104/200 [03:25<02:54,  1.82s/it] 52%|█████▎    | 105/200 [03:27<02:52,  1.81s/it] 53%|█████▎    | 106/200 [03:29<02:50,  1.81s/it] 54%|█████▎    | 107/200 [03:31<02:47,  1.80s/it] 54%|█████▍    | 108/200 [03:32<02:49,  1.84s/it] 55%|█████▍    | 109/200 [03:35<02:52,  1.90s/it] 55%|█████▌    | 110/200 [03:36<02:50,  1.89s/it] 56%|█████▌    | 111/200 [03:38<02:45,  1.86s/it] 56%|█████▌    | 112/200 [03:40<02:41,  1.83s/it] 56%|█████▋    | 113/200 [03:42<02:38,  1.82s/it] 57%|█████▋    | 114/200 [03:44<02:37,  1.83s/it] 57%|█████▊    | 115/200 [03:45<02:34,  1.82s/it] 58%|█████▊    | 116/200 [03:47<02:34,  1.84s/it] 58%|█████▊    | 117/200 [03:49<02:31,  1.83s/it] 59%|█████▉    | 118/200 [03:51<02:30,  1.83s/it] 60%|█████▉    | 119/200 [03:53<02:27,  1.82s/it] 60%|██████    | 120/200 [03:54<02:24,  1.81s/it] 60%|██████    | 121/200 [03:56<02:23,  1.82s/it] 61%|██████    | 122/200 [03:58<02:21,  1.81s/it] 62%|██████▏   | 123/200 [04:00<02:19,  1.81s/it] 62%|██████▏   | 124/200 [04:02<02:18,  1.83s/it] 62%|██████▎   | 125/200 [04:04<02:19,  1.86s/it] 63%|██████▎   | 126/200 [04:05<02:15,  1.83s/it] 64%|██████▎   | 127/200 [04:07<02:13,  1.83s/it] 64%|██████▍   | 128/200 [04:09<02:12,  1.84s/it] 64%|██████▍   | 129/200 [04:11<02:09,  1.83s/it] 65%|██████▌   | 130/200 [04:13<02:07,  1.82s/it] 66%|██████▌   | 131/200 [04:15<02:05,  1.83s/it] 66%|██████▌   | 132/200 [04:16<02:03,  1.82s/it] 66%|██████▋   | 133/200 [04:18<02:03,  1.84s/it] 67%|██████▋   | 134/200 [04:20<02:00,  1.82s/it] 68%|██████▊   | 135/200 [04:22<01:57,  1.81s/it] 68%|██████▊   | 136/200 [04:24<01:55,  1.81s/it] 68%|██████▊   | 137/200 [04:26<01:55,  1.83s/it] 69%|██████▉   | 138/200 [04:27<01:53,  1.84s/it] 70%|██████▉   | 139/200 [04:29<01:51,  1.83s/it] 70%|███████   | 140/200 [04:31<01:49,  1.83s/it] 70%|███████   | 141/200 [04:33<01:47,  1.82s/it] 71%|███████   | 142/200 [04:35<01:44,  1.81s/it] 72%|███████▏  | 143/200 [04:36<01:42,  1.80s/it] 72%|███████▏  | 144/200 [04:38<01:40,  1.80s/it] 72%|███████▎  | 145/200 [04:40<01:38,  1.80s/it] 73%|███████▎  | 146/200 [04:42<01:36,  1.79s/it] 74%|███████▎  | 147/200 [04:44<01:36,  1.81s/it] 74%|███████▍  | 148/200 [04:45<01:33,  1.80s/it] 74%|███████▍  | 149/200 [04:47<01:32,  1.81s/it] 75%|███████▌  | 150/200 [04:49<01:29,  1.80s/it] 76%|███████▌  | 151/200 [04:51<01:28,  1.80s/it] 76%|███████▌  | 152/200 [04:53<01:26,  1.79s/it] 76%|███████▋  | 153/200 [04:54<01:24,  1.79s/it] 77%|███████▋  | 154/200 [04:57<01:29,  1.95s/it] 78%|███████▊  | 155/200 [04:59<01:27,  1.94s/it] 78%|███████▊  | 156/200 [05:00<01:24,  1.91s/it] 78%|███████▊  | 157/200 [05:02<01:21,  1.88s/it] 79%|███████▉  | 158/200 [05:04<01:18,  1.87s/it] 80%|███████▉  | 159/200 [05:06<01:15,  1.85s/it] 80%|████████  | 160/200 [05:08<01:13,  1.83s/it] 80%|████████  | 161/200 [05:10<01:11,  1.83s/it] 81%|████████  | 162/200 [05:11<01:10,  1.85s/it] 82%|████████▏ | 163/200 [05:13<01:07,  1.83s/it] 82%|████████▏ | 164/200 [05:15<01:05,  1.83s/it] 82%|████████▎ | 165/200 [05:17<01:04,  1.85s/it] 83%|████████▎ | 166/200 [05:19<01:02,  1.85s/it] 84%|████████▎ | 167/200 [05:21<01:01,  1.86s/it] 84%|████████▍ | 168/200 [05:22<00:58,  1.83s/it] 84%|████████▍ | 169/200 [05:24<00:57,  1.86s/it] 85%|████████▌ | 170/200 [05:26<00:56,  1.87s/it] 86%|████████▌ | 171/200 [05:28<00:53,  1.85s/it] 86%|████████▌ | 172/200 [05:30<00:51,  1.84s/it] 86%|████████▋ | 173/200 [05:32<00:49,  1.82s/it] 87%|████████▋ | 174/200 [05:34<00:48,  1.86s/it] 88%|████████▊ | 175/200 [05:35<00:46,  1.87s/it] 88%|████████▊ | 176/200 [05:37<00:45,  1.88s/it] 88%|████████▊ | 177/200 [05:39<00:43,  1.87s/it] 89%|████████▉ | 178/200 [05:41<00:40,  1.85s/it] 90%|████████▉ | 179/200 [05:43<00:39,  1.86s/it] 90%|█████████ | 180/200 [05:45<00:37,  1.86s/it] 90%|█████████ | 181/200 [05:47<00:35,  1.85s/it] 91%|█████████ | 182/200 [05:48<00:32,  1.83s/it] 92%|█████████▏| 183/200 [05:50<00:30,  1.82s/it] 92%|█████████▏| 184/200 [05:52<00:29,  1.82s/it] 92%|█████████▎| 185/200 [05:54<00:27,  1.84s/it] 93%|█████████▎| 186/200 [05:56<00:26,  1.86s/it] 94%|█████████▎| 187/200 [05:58<00:24,  1.85s/it] 94%|█████████▍| 188/200 [05:59<00:22,  1.85s/it] 94%|█████████▍| 189/200 [06:02<00:22,  2.01s/it] 95%|█████████▌| 190/200 [06:04<00:19,  1.96s/it] 96%|█████████▌| 191/200 [06:05<00:17,  1.90s/it] 96%|█████████▌| 192/200 [06:08<00:16,  2.09s/it] 96%|█████████▋| 193/200 [06:10<00:14,  2.02s/it] 97%|█████████▋| 194/200 [06:12<00:11,  1.96s/it] 98%|█████████▊| 195/200 [06:14<00:09,  1.93s/it] 98%|█████████▊| 196/200 [06:15<00:07,  1.88s/it] 98%|█████████▊| 197/200 [06:17<00:05,  1.86s/it] 99%|█████████▉| 198/200 [06:19<00:03,  1.84s/it]100%|█████████▉| 199/200 [06:21<00:01,  1.82s/it]100%|██████████| 200/200 [06:22<00:00,  1.80s/it]100%|██████████| 200/200 [06:22<00:00,  1.91s/it]
INFO: [pid 33679] Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) done      ExtractAPIMangaData()
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   ExtractAPIMangaData__99914b932b   has status   DONE
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 4
INFO: [pid 33679] Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) running   TransformHotelData()
/home/shandytp/learn-luigi/pertemuan-14/live-class/etl_pipeline.py:191: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  transform_hotel_data[col] = transform_hotel_data[col].replace(CONVERT_VALUES)
INFO: [pid 33679] Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) done      TransformHotelData()
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   TransformHotelData__99914b932b   has status   DONE
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 3
INFO: [pid 33679] Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) running   TransformAnimeData()
INFO: [pid 33679] Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) done      TransformAnimeData()
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   TransformAnimeData__99914b932b   has status   DONE
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 2
INFO: [pid 33679] Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) running   TransformMangaData()
INFO: [pid 33679] Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) done      TransformMangaData()
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   TransformMangaData__99914b932b   has status   DONE
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 1
INFO: [pid 33679] Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) running   LoadData()
ERROR: [pid 33679] Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) failed    LoadData()
Traceback (most recent call last):
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/luigi/worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/luigi/worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/etl_pipeline.py", line 276, in run
    load_hotel_data.to_sql(name = hotel_data_name,
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/pandas/core/generic.py", line 3081, in to_sql
    return sql.to_sql(
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/pandas/io/sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/pandas/io/sql.py", line 2011, in to_sql
    table = self.prep_table(
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/pandas/io/sql.py", line 1915, in prep_table
    table.create()
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/pandas/io/sql.py", line 986, in create
    raise ValueError(f"Table '{self.name}' already exists.")
ValueError: Table 'hotel_data' already exists.
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   LoadData__99914b932b   has status   FAILED
DEBUG: Asking scheduler for work...
DEBUG: Done
DEBUG: There are no more tasks to run at this time
DEBUG: There are 1 pending tasks possibly being run by other workers
DEBUG: There are 1 pending tasks unique to this worker
DEBUG: There are 1 pending tasks last scheduled by this worker
INFO: Worker Worker(salt=3780212321, workers=1, host=shandytp, username=shandytp, pid=33679) was stopped. Shutting down Keep-Alive thread
INFO: 
===== Luigi Execution Summary =====

Scheduled 8 tasks of which:
* 1 complete ones were encountered:
    - 1 ValidateData()
* 6 ran successfully:
    - 1 ExtractAPIMangaData()
    - 1 ExtractAnimeData(year=2024, season=winter)
    - 1 ExtractHotelDatabase()
    - 1 TransformAnimeData()
    - 1 TransformHotelData()
    ...
* 1 failed:
    - 1 LoadData()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

Start Convert values Column is_canceled
End of Process
Start Convert values Column is_repeated_guest
End of Process
/home/shandytp/learn-luigi/pertemuan-14/live-class/etl_pipeline.py:1: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd
DEBUG: Checking if ExtractHotelDatabase() is complete
INFO: Informed scheduler that task   ExtractHotelDatabase__99914b932b   has status   DONE
DEBUG: Checking if ExtractAnimeData(year=2024, season=winter) is complete
INFO: Informed scheduler that task   ExtractAnimeData_winter_2024_307ccc7558   has status   DONE
DEBUG: Checking if ExtractAPIMangaData() is complete
INFO: Informed scheduler that task   ExtractAPIMangaData__99914b932b   has status   DONE
DEBUG: Checking if ValidateData() is complete
INFO: Informed scheduler that task   ValidateData__99914b932b   has status   DONE
DEBUG: Checking if TransformHotelData() is complete
INFO: Informed scheduler that task   TransformHotelData__99914b932b   has status   DONE
DEBUG: Checking if TransformAnimeData() is complete
INFO: Informed scheduler that task   TransformAnimeData__99914b932b   has status   DONE
DEBUG: Checking if TransformMangaData() is complete
INFO: Informed scheduler that task   TransformMangaData__99914b932b   has status   DONE
DEBUG: Checking if LoadData() is complete
DEBUG: Checking if TransformHotelData() is complete
DEBUG: Checking if TransformAnimeData() is complete
DEBUG: Checking if TransformMangaData() is complete
INFO: Informed scheduler that task   LoadData__99914b932b   has status   PENDING
INFO: Informed scheduler that task   TransformMangaData__99914b932b   has status   DONE
INFO: Informed scheduler that task   TransformAnimeData__99914b932b   has status   DONE
INFO: Informed scheduler that task   TransformHotelData__99914b932b   has status   DONE
INFO: Done scheduling tasks
INFO: Running Worker with 1 processes
DEBUG: Asking scheduler for work...
DEBUG: Pending tasks: 1
INFO: [pid 34797] Worker Worker(salt=732730131, workers=1, host=shandytp, username=shandytp, pid=34797) running   LoadData()
ERROR: [pid 34797] Worker Worker(salt=732730131, workers=1, host=shandytp, username=shandytp, pid=34797) failed    LoadData()
Traceback (most recent call last):
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/luigi/worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/luigi/worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/etl_pipeline.py", line 266, in run
    load_hotel_data = pd.read_csv(self.input()[0].path)
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 1024, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 618, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 1618, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/pandas/io/parsers/readers.py", line 1896, in _make_engine
    return mapping[engine](f, **self.options)
  File "/home/shandytp/learn-luigi/pertemuan-14/live-class/venv/lib/python3.9/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
DEBUG: 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   LoadData__99914b932b   has status   FAILED
DEBUG: Asking scheduler for work...
DEBUG: Done
DEBUG: There are no more tasks to run at this time
DEBUG: There are 1 pending tasks possibly being run by other workers
DEBUG: There are 1 pending tasks unique to this worker
DEBUG: There are 1 pending tasks last scheduled by this worker
INFO: Worker Worker(salt=732730131, workers=1, host=shandytp, username=shandytp, pid=34797) was stopped. Shutting down Keep-Alive thread
INFO: 
===== Luigi Execution Summary =====

Scheduled 8 tasks of which:
* 7 complete ones were encountered:
    - 1 ExtractAPIMangaData()
    - 1 ExtractAnimeData(year=2024, season=winter)
    - 1 ExtractHotelDatabase()
    - 1 TransformAnimeData()
    - 1 TransformHotelData()
    ...
* 1 failed:
    - 1 LoadData()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

